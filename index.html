<!DOCTYPE html>
<html>
    <head>
    <meta name = viewport content = "width = device-width, initial-scale = 1">
        <style>
             body, html {
                height: 100%;
                background-color: black;
                color: white;
            }

            body {
                margin: 0;
                overflow: hidden;
            }
        </style>        
    </head>
    <body>
        <div style="width:100%;height:100%;max-width:100%">
            <div id="game"></div>
        </div>
        <script>
            EJS_player = "#game";
            EJS_core = "mednafen_psx_hw";
            EJS_gameName = "NSK WARRIOR";
            EJS_fullscreenOnLoaded = true;
            EJS_color = "#800000";
            EJS_backgroundImage = "/cover.png";
            EJS_backgroundColor = "#000000";
            EJS_startOnLoaded = false;
            EJS_pathtodata = "data/";
            EJS_loadStateURL = "RPG Maker (USA).state";
            EJS_gameUrl = "RPG Maker (USA).zip";
            EJS_biosUrl = "scph5501.bin";
            EJS_VirtualGamepadSettings = [
                {
                    type: "button",
                    text: "Y",
                    id: "y",
                    location: "right",
                    left: 40,
                    bold: true,
                    input_value: 9
                },
                {
                    type: "button",
                    text: "X",
                    id: "X",
                    location: "right",
                    top: 40,
                    bold: true,
                    input_value: 1
                },
                {
                    type: "button",
                    text: "B",
                    id: "b",
                    location: "right",
                    left: 81,
                    top: 40,
                    bold: true,
                    input_value: 8
                },
                {
                    type: "button",
                    text: "A",
                    id: "a",
                    location: "right",
                    left: 40,
                    top: 80,
                    bold: true,
                    input_value: 0
                },
                {
                    type: "dpad",
                    location: "left",
                    left: "50%",
                    right: "50%",
                    joystickInput: false,
                    inputValues: [4, 5, 6, 7]
                }
            ]
            EJS_onGameStart = function(e) {
                (async() => {
                    let sleep = (ms) => new Promise(r => setTimeout(r, ms));
                    let state = "suspended";
                    let popup;
                    while (state === "suspended") {
                        if (!window.AL) return;
                        AL.currentCtx.sources.forEach(ctx => {
                            state = ctx.gain.context.state;
                        });
                        if (state !== "suspended") break;
                        if (!popup) {
                            popup = EJS_emulator.createPopup("", {});
                            const button = EJS_emulator.createElement("div");
                            button.innerText = "Click to resume Emulator";
                            button.style.width = "25%";
                            button.style.height = "25%";
                            popup.appendChild(button);
                            button.style["text-align"] = "center";
                            button.style["font-size"] = "28px";
                        }
                        await sleep(10);
                    }
                    if (popup) EJS_emulator.closePopup();
                })();
            }
        </script>
        <script src="data/loader.js"></script>
    </body>
</html>
